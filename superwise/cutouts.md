---
jupytext:
  text_representation:
    extension: .md
    format_name: myst
    format_version: 0.13
    jupytext_version: 1.16.0
kernelspec:
  display_name: root *
  language: python
  name: conda-root-py
---

# Super WISE: To Enhance WISE images learning from Spitzer

By the IPAC Science Platform Team, started: Apr 24, 2024- last edit: Apr 24, 2024

***

```{code-cell} ipython3
#!pip install -r requirements.txt

import sys
sys.path.append('code_src/')

from astropy.table import Table
from astropy.io import fits
from astropy.nddata import Cutout2D
from astropy.wcs import WCS
from astropy.coordinates import SkyCoord
from astropy import units as u
from astroquery.ipac.irsa import Irsa

import numpy as np
import pandas as pd
import matplotlib.pyplot as plt

ras = [53.1016865, 53.0884484, 53.0720028, 53.0990123, 53.1462097, 53.1540879,
    53.1143036, 53.1641068, 53.1461636, 53.2072268, 53.1503938, 53.2076163,
    53.09177, 53.1021871, 53.1362766, 53.1454835, 53.2141874, 53.2073151,
    53.1894621, 53.2103125, 53.1842558, 53.242204, 53.1048801, 53.1351058,
    53.222262, 53.0925338, 53.0572668, 53.0807852, 53.2245732, 53.1387709,
    53.2536293, 53.1342812, 53.1772898, 53.0597172, 53.1400007, 53.1783983,
    53.1967279, 53.1855768, 53.0948418, 53.211377, 53.1083032, 53.0673,
    53.0793301, 53.1844508, 53.231738, 53.1835471, 53.2171814, 53.2318249,
    53.0583498, 53.2299966, 53.2290964, 53.1005658, 53.0744585, 53.0636339,
    53.1699492, 53.1172495, 53.0640437, 53.0838823, 53.1617572, 53.1177705,
    53.1149411, 53.2219974, 53.1310935, 53.1150068, 53.1499011, 53.0741284,
    53.0624529, 53.1383658, 53.0474044, 53.1361059, 53.0767434, 53.2038052,
    53.1999257, 53.0248202, 53.0972226, 53.0312059, 53.0781322, 53.221863,
    53.2123594, 53.1438381, 53.0645347, 53.2066531, 53.2096622, 53.1038762,
    53.2347296, 53.079703, 53.1747782, 53.2317196, 53.2054489, 53.1047181,
    53.1869383, 53.1939267, 53.1421196, 53.0262009, 53.1166389, 53.1166252,
    53.1397277, 53.1505962, 53.2026671, 53.1580322, 53.2095838, 53.1773499,
    53.0846399, 53.2018323, 53.1704531, 53.0600947, 53.1879053, 53.2034974,
    53.1729518, 53.1897959, 53.2114451, 53.1713255, 53.0785137, 53.2223376,
    53.04299, 53.2197725, 53.2211316, 53.0447581, 53.0448139, 53.0176029,
    53.0799157, 53.2040731, 53.0407281, 53.1394914, 53.2050315, 53.115021,
    53.1137442, 53.0272879, 53.0906366, 53.163249, 53.1271857, 53.1180817,
    53.107973, 53.1240187, 53.1866422, 53.124477, 53.1045611, 53.1227549,
    53.1391141, 53.0782397, 53.1249605, 53.1200678, 53.1876634, 53.1707473,
    53.0429518, 53.1707334, 53.1603391, 53.2055152, 53.1394251, 53.1939365,
    53.1225948, 53.1669884, 53.1744929, 52.9969528, 53.0557497, 53.1979648,
    53.1733515, 53.064823, 53.1749437, 53.1682555, 53.1447529, 53.1105337,
    53.1589711, 53.133854, 53.0112941, 53.1694938, 53.0825376, 53.0844452,
    53.0383141, 53.1677269, 53.1540943, 53.0286574, 53.0582458, 53.0196529,
    53.1690839, 53.1663382, 53.1675704, 53.0561554]
decs = [
    -27.9584786, -27.9341995, -27.9324571, -27.9245559, -27.9245272, -27.9233587,
    -27.9223383, -27.9186358, -27.9258091, -27.9161896, -27.9169205, -27.9141329,
    -27.9078953, -27.9119265, -27.9063466, -27.9038478, -27.9054073, -27.901093,
    -27.9042908, -27.9057874, -27.899627, -27.8988661, -27.9009879, -27.8951824,
    -27.8925434, -27.8922698, -27.8918825, -27.8920926, -27.8983372, -27.8880884,
    -27.885366, -27.8878994, -27.8811974, -27.877733, -27.8784406, -27.8779515,
    -27.8754764, -27.8736191, -27.8733205, -27.873662, -27.872217, -27.8701016,
    -27.8622028, -27.8614093, -27.8585983, -27.8620449, -27.8524191, -27.857274,
    -27.850189, -27.8507697, -27.8508524, -27.8461199, -27.8497988, -27.8442326,
    -27.8430939, -27.843028, -27.8458281, -27.8358436, -27.8322951, -27.8304661,
    -27.8281156, -27.826334, -27.829235, -27.8272503, -27.8239001, -27.823979,
    -27.8225088, -27.8224579, -27.8216262, -27.8290403, -27.8174705, -27.8181032,
    -27.8154683, -27.8127316, -27.8145776, -27.8109127, -27.8094685, -27.8093052,
    -27.8100793, -27.8134727, -27.8073618, -27.8074819, -27.8066388, -27.8040708,
    -27.8093715, -27.8, -27.7993218, -27.7926531, -27.7906309, -27.7900934,
    -27.7909914, -27.7857986, -27.7866994, -27.7854287, -27.7771322, -27.7775669,
    -27.7731559, -27.7716505, -27.7739411, -27.7692108, -27.7684542, -27.7639335,
    -27.7652293, -27.7640595, -27.7613626, -27.7613056, -27.7615541, -27.7587525,
    -27.7590355, -27.7588826, -27.7571468, -27.7574555, -27.7581142, -27.7524735,
    -27.7535664, -27.7497729, -27.755208, -27.7509394, -27.7526858, -27.7544993,
    -27.7461973, -27.7414382, -27.7451174, -27.741767, -27.7433246, -27.7419637,
    -27.7412975, -27.7402533, -27.7450253, -27.7384579, -27.7403282, -27.7406167,
    -27.7337435, -27.73345, -27.735074, -27.7401988, -27.7342132, -27.7353922,
    -27.7303049, -27.7249262, -27.7346729, -27.7321241, -27.7253835, -27.7229294,
    -27.7214029, -27.7219295, -27.7204973, -27.7172553, -27.7202046, -27.7046012,
    -27.7079072, -27.707781, -27.6676193, -27.7127251, -27.7110646, -27.7136712,
    -27.7149638, -27.7166228, -27.6636749, -27.6635293, -27.665949, -27.7177104,
    -27.6697808, -27.7165441, -27.7196737, -27.7211652, -27.689653, -27.6923171,
    -27.6966482, -27.6974845, -27.6979345, -27.7021072, -27.7026285, -27.7040879,
    -27.7072928, -27.7059777, -27.7062279, -27.7031374]
```

***

## 1) cutouts from WISE and Spitzer images

```{code-cell} ipython3
# a coordinate in the GOODS-S field to query for the image urls 
coord = SkyCoord(53.0884484,-27.9341995, unit='deg')

#To find the collections in irsa 
#from astroquery.ipac.irsa import Irsa
#Irsa.list_collections()

spitzer_images = Irsa.query_sia(pos=(coord, 15 * u.arcmin), collection='spitzer_scandels').to_table()
science_images = spitzer_images[spitzer_images['dataproduct_subtype'] == 'science']

WISE_images = Irsa.query_sia(pos=(coord, 15 * u.arcmin), collection='wise_allwise').to_table()
wscience_images = WISE_images[WISE_images['dataproduct_subtype'] == 'science']
```

```{code-cell} ipython3
for r,d in zip(ras,decs):
    coord = SkyCoord(r,d, unit='deg')

    plt.figure(figsize=(10,3))
    for s in science_images:
        if s['energy_bandpassname']=='IRAC1':
            ax0 = plt.subplot(1,4,3)
        elif s['energy_bandpassname']=='IRAC2':
            ax0 = plt.subplot(1,4,4)
        else:
            continue    
        with fits.open(s['access_url'], use_fsspec=True) as hdul:
            try:
                cutout_s = Cutout2D(hdul[0].section, position=coord, size=25 * u.arcsec, wcs=WCS(hdul[0].header))
                ax0.imshow(cutout_s.data,origin='lower')
                ax0.text(2,2,str(s['energy_bandpassname']),color='y')
                ax0.axis('off')
            except:
                ax0.text(2,2,str(s['energy_bandpassname']),color='y')
                ax0.axis('off') 

    for w in wscience_images:
        if w['energy_bandpassname']=='W1':
            ax0 = plt.subplot(1,4,1)
        elif w['energy_bandpassname']=='W2':
            ax0 = plt.subplot(1,4,2)
        else:
            continue
        
        with fits.open(w['access_url'], use_fsspec=True) as hdul:
            try:
                cutout_w = Cutout2D(hdul[0].section, position=coord, size=25 * u.arcsec, wcs=WCS(hdul[0].header))
                ax0.imshow(cutout_w.data,origin='lower')
                ax0.text(2,2,str(w['energy_bandpassname']),color='y')
                ax0.axis('off')
            except:
                ax0.text(2,2,str(w['energy_bandpassname']),color='y')
                ax0.axis('off') 
    plt.show()
```

```{code-cell} ipython3

```
